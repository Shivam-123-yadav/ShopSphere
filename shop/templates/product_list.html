{% extends "base.html" %}
{% block content %}

<h3 class="mb-4 fw-bold text-gradient" style="letter-spacing:1px;">Products</h3>

<!-- Search + Filter Form -->
<form method="get" class="row g-2 mb-4 p-3 rounded-4 shadow-sm bg-white bg-opacity-75 border border-2 border-warning-subtle animate__animated animate__fadeInDown">
  <div class="col-12 col-sm-6 col-md-3">
    <input type="text" name="q" class="form-control rounded-pill" placeholder="Search products..." value="{{ query }}">
  </div>
  <div class="col-12 col-sm-6 col-md-2">
    <select name="category" class="form-select rounded-pill">
      <option value="">All Categories</option>
      {% for cat in categories %}
        <option value="{{ cat.id }}" {% if selected_category == cat.id|stringformat:"s" %}selected{% endif %}>{{ cat.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-6 col-md-2">
    <input type="number" name="min_price" class="form-control rounded-pill" placeholder="Min Price" value="{{ min_price }}">
  </div>
  <div class="col-6 col-md-2">
    <input type="number" name="max_price" class="form-control rounded-pill" placeholder="Max Price" value="{{ max_price }}">
  </div>
  <div class="col-6 col-md-2">
    <select name="sort" class="form-select rounded-pill">
      <option value="">Sort By</option>
      <option value="price_asc" {% if sort == "price_asc" %}selected{% endif %}>Price Low → High</option>
      <option value="price_desc" {% if sort == "price_desc" %}selected{% endif %}>Price High → Low</option>
      <option value="newest" {% if sort == "newest" %}selected{% endif %}>Newest</option>
    </select>
  </div>
  <div class="col-6 col-md-1">
    <button class="btn btn-warning w-100 rounded-pill fw-bold shadow-sm"><i class="fas fa-filter me-1"></i>Go</button>
  </div>
</form>


<!-- Product Grid -->
<div class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4 animate__animated animate__fadeInUp">
  {% for product in products %}
  <div class="col">
    <div class="card h-100 border-0 shadow-lg product-card position-relative overflow-hidden animate__animated animate__zoomIn" style="transition:transform 0.2s;">
      <div class="position-relative">
        {% if product.images.first %}
          <img src="{{ product.images.first.image.url }}" class="card-img-top product-img" alt="{{ product.name }}" style="height:210px; object-fit:cover; border-radius:1.2rem 1.2rem 0 0;">
        {% else %}
          <img src="https://via.placeholder.com/200x150" class="card-img-top product-img" alt="{{ product.name }}" style="height:210px; object-fit:cover; border-radius:1.2rem 1.2rem 0 0;">
        {% endif %}
        <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2 shadow-sm fs-6">₹{{ product.price }}</span>
        <div class="product-img-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center" style="background:rgba(0,0,0,0.18); opacity:0; transition:opacity 0.3s;">
          <a href="{% url 'product_detail' product.slug %}" class="btn btn-light btn-sm fw-bold shadow">View Details <i class="fas fa-arrow-right ms-1"></i></a>
        </div>
      </div>
      <div class="card-body d-flex flex-column justify-content-between">
        <h6 class="card-title fw-bold text-dark mb-2" style="min-height:2.2em;">{{ product.name }}</h6>
        <a href="{% url 'product_detail' product.slug %}" class="btn btn-outline-warning btn-sm mt-auto fw-bold">View</a>
      </div>
    </div>
  </div>
  {% empty %}
    <p class="text-center">No products found.</p>
  {% endfor %}
</div>

<style>
.text-gradient {
  background: linear-gradient(90deg, #FFD700, #FFA500 80%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.product-card {
  border-radius: 1.2rem;
  box-shadow: 0 6px 32px rgba(0,0,0,0.10);
  transition: transform 0.18s, box-shadow 0.18s;
}
.product-card:hover {
  transform: translateY(-7px) scale(1.03);
  box-shadow: 0 12px 36px #FFD70033;
}
.product-img-overlay {
  opacity: 0;
  pointer-events: none;
}
.product-card:hover .product-img-overlay {
  opacity: 1;
  pointer-events: auto;
}
.product-img {
  transition: filter 0.3s;
}
.product-card:hover .product-img {
  filter: brightness(0.85) blur(1px);
}
@media (max-width: 576px) {
  .product-img { height: 150px !important; }
}
</style>

{% endblock %}
